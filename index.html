<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>คำนวณภาษีเงินได้บุคคลธรรมดา</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .section-card {
            margin-bottom: 20px;
            border: 1px solid #dee2e6;
            border-radius: 8px;
        }
        .section-header {
            background-color: #f8f9fa;
            padding: 12px 15px;
            cursor: pointer;
            border-bottom: 1px solid #dee2e6;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .section-body {
            padding: 15px;
        }
        .hidden {
            display: none;
        }
        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        .tax-bracket {
            margin-left: 20px;
            font-size: 0.9em;
        }
        .result-section {
            background-color: #e9f7ef;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin-top: 20px;
        }
        .savings-section {
            background-color: #e7f3ff;
            border-left: 4px solid #007bff;
            padding: 15px;
            margin-top: 15px;
        }
        .form-section {
            margin-bottom: 15px;
        }
        .form-label {
            font-weight: 500;
        }
        .highlight {
            font-weight: bold;
            color: #dc3545;
        }
        .positive {
            color: #28a745;
        }
    </style>
</head>
<body>
    <div class="container my-4">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <h1 class="text-center mb-4">คำนวณภาษีเงินได้บุคคลธรรมดา</h1>
                
                <!-- ส่วนกรอกข้อมูลเงินได้พึงประเมิน -->
                <div class="section-card">
                    <div class="section-header" id="income-header">
                        <h5 class="mb-0">เงินได้พึงประเมิน</h5>
                        <span class="badge bg-secondary" id="income-summary">0 บาท</span>
                    </div>
                    <div class="section-body" id="income-body">
                        <p class="text-muted mb-3">กรุณาระบุรายละเอียดเงินได้ตามประเภทต่างๆ</p>
                        
                        <!-- ประเภทที่ 1: เงินได้จากงานประจำ -->
                        <div class="form-section">
                            <h6>ประเภทที่ 1: เงินได้จากการจ้างงาน</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <label class="form-label">เงินเดือน/ค่าจ้าง</label>
                                    <input type="number" class="form-control income-input" id="income-type1" data-type="1" placeholder="0">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">เงินได้อื่นๆ จากงานประจำ</label>
                                    <input type="number" class="form-control income-input" id="income-type1-other" data-type="1" placeholder="0">
                                </div>
                            </div>
                        </div>
                        
                        <!-- ประเภทที่ 2: เงินได้จากการรับจ้างทำของ -->
                        <div class="form-section">
                            <h6>ประเภทที่ 2: เงินได้จากการรับจ้างทำของ</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <label class="form-label">รายได้จากการรับจ้างทำของ</label>
                                    <input type="number" class="form-control income-input" id="income-type2" data-type="2" placeholder="0">
                                </div>
                            </div>
                        </div>
                        
                        <!-- ประเภทที่ 3: ค่าสิทธิ -->
                        <div class="form-section">
                            <h6>ประเภทที่ 3: ค่าสิทธิ</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <label class="form-label">ค่าลิขสิทธิ์/สิทธิบัตร</label>
                                    <input type="number" class="form-control income-input" id="income-type3" data-type="3" placeholder="0">
                                </div>
                            </div>
                        </div>
                        
                        <!-- ประเภทที่ 4: ดอกเบี้ย เงินปันผล -->
                        <div class="form-section">
                            <h6>ประเภทที่ 4: ดอกเบี้ย เงินปันผล ฯลฯ</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <label class="form-label">ดอกเบี้ยรับ</label>
                                    <input type="number" class="form-control income-input" id="income-type4-1" data-type="4" placeholder="0">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">เงินปันผล</label>
                                    <input type="number" class="form-control income-input" id="income-type4-2" data-type="4" placeholder="0">
                                </div>
                            </div>
                        </div>
                        
                        <!-- ประเภทที่ 5: เงินได้จากการให้เช่าทรัพย์สิน -->
                        <div class="form-section">
                            <h6>ประเภทที่ 5: เงินได้จากการให้เช่าทรัพย์สิน</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <label class="form-label">ค่าเช่าอสังหาริมทรัพย์</label>
                                    <input type="number" class="form-control income-input" id="income-type5" data-type="5" placeholder="0">
                                </div>
                            </div>
                        </div>
                        
                        <!-- ประเภทที่ 6: เงินได้จากวิชาชีพอิสระ -->
                        <div class="form-section">
                            <h6>ประเภทที่ 6: เงินได้จากวิชาชีพอิสระ</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <label class="form-label">รายได้จากวิชาชีพอิสระ</label>
                                    <input type="number" class="form-control income-input" id="income-type6" data-type="6" placeholder="0">
                                </div>
                            </div>
                        </div>
                        
                        <!-- ประเภทที่ 7: เงินได้จากการรับเหมา -->
                        <div class="form-section">
                            <h6>ประเภทที่ 7: เงินได้จากการรับเหมา</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <label class="form-label">รายได้จากการรับเหมา</label>
                                    <input type="number" class="form-control income-input" id="income-type7" data-type="7" placeholder="0">
                                </div>
                            </div>
                        </div>
                        
                        <!-- ประเภทที่ 8: เงินได้จากธุรกิจ การค้า เกษตร -->
                        <div class="form-section">
                            <h6>ประเภทที่ 8: เงินได้จากธุรกิจ การค้า เกษตร</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <label class="form-label">รายได้จากธุรกิจ/การค้า</label>
                                    <input type="number" class="form-control income-input" id="income-type8" data-type="8" placeholder="0">
                                </div>
                            </div>
                        </div>
                        
                        <button class="btn btn-primary mt-3" id="confirm-income">ยืนยันเงินได้พึงประเมิน</button>
                    </div>
                </div>
                
                <!-- ส่วนกรอกข้อมูลลดหย่อนภาษี -->
                <div class="section-card">
                    <div class="section-header" id="deductions-header">
                        <h5 class="mb-0">ค่าลดหย่อนภาษี</h5>
                        <span class="badge bg-secondary" id="deductions-summary">0 บาท</span>
                    </div>
                    <div class="section-body hidden" id="deductions-body">
                        <p class="text-muted mb-3">กรุณาระบุรายการลดหย่อนภาษี</p>
                        
                        <!-- ส่วนลดหย่อนประกันชีวิตและสุขภาพ -->
                        <div class="form-section">
                            <h6>ประกันชีวิตและสุขภาพ</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <label class="form-label">เบี้ยประกันชีวิต</label>
                                    <input type="number" class="form-control deduction-input" id="deduction-life" placeholder="0">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">เบี้ยประกันสุขภาพ</label>
                                    <input type="number" class="form-control deduction-input" id="deduction-health" placeholder="0">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">เบี้ยประกันโรคภัย</label>
                                    <input type="number" class="form-control deduction-input" id="deduction-illness" placeholder="0">
                                </div>
                            </div>
                        </div>
                        
                        <!-- ส่วนลดหย่อนประกันบำนาญ -->
                        <div class="form-section">
                            <h6>ประกันบำนาญ</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <label class="form-label">เบี้ยประกันบำนาญ</label>
                                    <input type="number" class="form-control deduction-input" id="deduction-pension" placeholder="0">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">เงินสะสมกองทุนสำรองเลี้ยงชีพ</label>
                                    <input type="number" class="form-control deduction-input" id="deduction-pvf" placeholder="0">
                                </div>
                            </div>
                        </div>
                        
                        <!-- ส่วนลดหย่อนอื่นๆ -->
                        <div class="form-section">
                            <h6>ค่าลดหย่อนอื่นๆ</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <label class="form-label">เงินบริจาค</label>
                                    <input type="number" class="form-control deduction-input" id="deduction-donation" placeholder="0">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">ดอกเบี้ยกู้ยืมที่อยู่อาศัย</label>
                                    <input type="number" class="form-control deduction-input" id="deduction-housing-loan" placeholder="0">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">ค่าลดหย่อนส่วนตัว</label>
                                    <input type="number" class="form-control" id="deduction-personal" value="60000" readonly>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">ค่าลดหย่อนคู่สมรส</label>
                                    <input type="number" class="form-control deduction-input" id="deduction-spouse" placeholder="0">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">ค่าลดหย่อนบุตร</label>
                                    <input type="number" class="form-control deduction-input" id="deduction-children" placeholder="0">
                                </div>
                            </div>
                        </div>
                        
                        <button class="btn btn-primary mt-3" id="confirm-deductions">ยืนยันค่าลดหย่อน</button>
                    </div>
                </div>
                
                <!-- ส่วนแสดงผลการคำนวณภาษี -->
                <div class="section-card">
                    <div class="section-header" id="results-header">
                        <h5 class="mb-0">ผลการคำนวณภาษี</h5>
                    </div>
                    <div class="section-body hidden" id="results-body">
                        <div class="summary-row">
                            <span>เงินได้พึงประเมินรวม:</span>
                            <span id="total-income">0 บาท</span>
                        </div>
                        <div class="summary-row">
                            <span>หักค่าใช้จ่าย:</span>
                            <span id="total-expenses">0 บาท</span>
                        </div>
                        <div class="summary-row">
                            <span>เงินได้สุทธิ:</span>
                            <span id="net-income">0 บาท</span>
                        </div>
                        <div class="summary-row">
                            <span>หักค่าลดหย่อน:</span>
                            <span id="total-deductions">0 บาท</span>
                        </div>
                        <div class="summary-row">
                            <span>เงินได้หลังหักลดหย่อน:</span>
                            <span id="taxable-income">0 บาท</span>
                        </div>
                        
                        <div class="result-section">
                            <h5>ภาษีที่ต้องชำระ: <span id="tax-amount" class="highlight">0 บาท</span></h5>
                            <div id="tax-breakdown" class="tax-bracket"></div>
                        </div>
                        
                        <div class="savings-section">
                            <h6>การลดหย่อนเพิ่มเติมเพื่อประหยัดภาษี</h6>
                            <div class="summary-row">
                                <span>ลดหย่อนประกันชีวิตและสุขภาพได้อีกสูงสุด:</span>
                                <span id="max-life-health">0 บาท</span>
                            </div>
                            <div class="summary-row">
                                <span>ลดหย่อนประกันบำนาญได้อีกสูงสุด:</span>
                                <span id="max-pension">0 บาท</span>
                            </div>
                            <div class="summary-row">
                                <span>ช่วยประหยัดภาษีได้สูงสุด:</span>
                                <span id="potential-savings" class="positive">0 บาท (0%)</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="text-center mt-4">
                    <button class="btn btn-success btn-lg" id="calculate-tax">คำนวณภาษี</button>
                    <button class="btn btn-secondary btn-lg" id="reset-form">เริ่มใหม่</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ตัวแปรเก็บข้อมูล
            let incomeData = {
                type1: 0,
                type1Other: 0,
                type2: 0,
                type3: 0,
                type4_1: 0,
                type4_2: 0,
                type5: 0,
                type6: 0,
                type7: 0,
                type8: 0
            };
            
            let deductionData = {
                life: 0,
                health: 0,
                illness: 0,
                pension: 0,
                pvf: 0,
                donation: 0,
                housingLoan: 0,
                personal: 60000,
                spouse: 0,
                children: 0
            };
            
            // ฟังก์ชันคำนวณค่าใช้จ่ายตามประเภทเงินได้
            function calculateExpenses(type, amount) {
                switch(type) {
                    case 1: // เงินได้จากการจ้างงาน - หัก 50% แต่ไม่เกิน 100,000 บาท
                        return Math.min(amount * 0.5, 100000);
                    case 2: // เงินได้จากการรับจ้างทำของ - หัก 70% แต่ไม่เกิน 100,000 บาท
                        return Math.min(amount * 0.7, 100000);
                    case 3: // ค่าสิทธิ - หักตามจริง แต่ไม่เกิน 100,000 บาท
                        return Math.min(amount * 1, 100000);
                    case 4: // ดอกเบี้ย เงินปันผล - หักตามจริง แต่ไม่เกิน 100,000 บาท
                        return Math.min(amount * 1, 100000);
                    case 5: // เงินได้จากการให้เช่าทรัพย์สิน - หักตามจริง แต่ไม่เกิน 100,000 บาท
                        return Math.min(amount * 1, 100000);
                    case 6: // เงินได้จากวิชาชีพอิสระ - หักตามจริง แต่ไม่เกิน 100,000 บาท
                        return Math.min(amount * 1, 100000);
                    case 7: // เงินได้จากการรับเหมา - หักตามจริง แต่ไม่เกิน 100,000 บาท
                        return Math.min(amount * 1, 100000);
                    case 8: // เงินได้จากธุรกิจ การค้า เกษตร - หักตามจริง แต่ไม่เกิน 100,000 บาท
                        return Math.min(amount * 1, 100000);
                    default:
                        return 0;
                }
            }
            
            // ฟังก์ชันคำนวณภาษีตามขั้นบันได
            function calculateTax(taxableIncome) {
                let tax = 0;
                const brackets = [
                    { limit: 150000, rate: 0 },
                    { limit: 300000, rate: 0.05 },
                    { limit: 500000, rate: 0.10 },
                    { limit: 750000, rate: 0.15 },
                    { limit: 1000000, rate: 0.20 },
                    { limit: 2000000, rate: 0.25 },
                    { limit: 5000000, rate: 0.30 },
                    { limit: Infinity, rate: 0.35 }
                ];
                
                let remainingIncome = taxableIncome;
                let breakdown = [];
                
                for (let i = 0; i < brackets.length; i++) {
                    const bracket = brackets[i];
                    const prevLimit = i === 0 ? 0 : brackets[i-1].limit;
                    const bracketRange = bracket.limit - prevLimit;
                    
                    if (remainingIncome > bracketRange) {
                        const bracketTax = bracketRange * bracket.rate;
                        tax += bracketTax;
                        breakdown.push({
                            range: `${prevLimit.toLocaleString()} - ${bracket.limit.toLocaleString()}`,
                            rate: `${bracket.rate * 100}%`,
                            tax: bracketTax.toLocaleString()
                        });
                        remainingIncome -= bracketRange;
                    } else {
                        const bracketTax = remainingIncome * bracket.rate;
                        tax += bracketTax;
                        breakdown.push({
                            range: `${prevLimit.toLocaleString()} - ${bracket.limit.toLocaleString()}`,
                            rate: `${bracket.rate * 100}%`,
                            tax: bracketTax.toLocaleString()
                        });
                        break;
                    }
                }
                
                return { total: tax, breakdown };
            }
            
            // ฟังก์ชันคำนวณภาษีทั้งหมด
            function calculateTotalTax() {
                // คำนวณเงินได้สุทธิ
                let totalIncome = 0;
                let totalExpenses = 0;
                
                // ประเภท 1
                const income1 = incomeData.type1 + incomeData.type1Other;
                const expense1 = calculateExpenses(1, income1);
                totalIncome += income1;
                totalExpenses += expense1;
                
                // ประเภท 2
                const expense2 = calculateExpenses(2, incomeData.type2);
                totalIncome += incomeData.type2;
                totalExpenses += expense2;
                
                // ประเภท 3
                const expense3 = calculateExpenses(3, incomeData.type3);
                totalIncome += incomeData.type3;
                totalExpenses += expense3;
                
                // ประเภท 4
                const income4 = incomeData.type4_1 + incomeData.type4_2;
                const expense4 = calculateExpenses(4, income4);
                totalIncome += income4;
                totalExpenses += expense4;
                
                // ประเภท 5
                const expense5 = calculateExpenses(5, incomeData.type5);
                totalIncome += incomeData.type5;
                totalExpenses += expense5;
                
                // ประเภท 6
                const expense6 = calculateExpenses(6, incomeData.type6);
                totalIncome += incomeData.type6;
                totalExpenses += expense6;
                
                // ประเภท 7
                const expense7 = calculateExpenses(7, incomeData.type7);
                totalIncome += incomeData.type7;
                totalExpenses += expense7;
                
                // ประเภท 8
                const expense8 = calculateExpenses(8, incomeData.type8);
                totalIncome += incomeData.type8;
                totalExpenses += expense8;
                
                const netIncome = totalIncome - totalExpenses;
                
                // คำนวณค่าลดหย่อน
                const totalDeductions = Object.values(deductionData).reduce((sum, value) => sum + value, 0);
                
                // คำนวณเงินได้หลังหักลดหย่อน
                const taxableIncome = Math.max(0, netIncome - totalDeductions);
                
                // คำนวณภาษี
                const taxResult = calculateTax(taxableIncome);
                
                // คำนวณโอกาสลดหย่อนเพิ่มเติม
                const maxLifeHealthDeduction = Math.min(100000, netIncome * 0.15);
                const maxPensionDeduction = Math.min(300000, netIncome * 0.15);
                
                const currentLifeHealth = deductionData.life + deductionData.health + deductionData.illness;
                const currentPension = deductionData.pension + deductionData.pvf;
                
                const availableLifeHealth = Math.max(0, maxLifeHealthDeduction - currentLifeHealth);
                const availablePension = Math.max(0, maxPensionDeduction - currentPension);
                
                // คำนวณภาษีที่ประหยัดได้หากใช้สิทธิเต็มที่
                const additionalDeductions = availableLifeHealth + availablePension;
                const newTaxableIncome = Math.max(0, taxableIncome - additionalDeductions);
                const newTaxResult = calculateTax(newTaxableIncome);
                
                const potentialSavings = taxResult.total - newTaxResult.total;
                const savingsPercentage = taxResult.total > 0 ? (potentialSavings / taxResult.total * 100).toFixed(2) : 0;
                
                return {
                    totalIncome,
                    totalExpenses,
                    netIncome,
                    totalDeductions,
                    taxableIncome,
                    tax: taxResult.total,
                    taxBreakdown: taxResult.breakdown,
                    availableLifeHealth,
                    availablePension,
                    potentialSavings,
                    savingsPercentage
                };
            }
            
            // อัพเดทสรุปเงินได้
            function updateIncomeSummary() {
                const total = Object.values(incomeData).reduce((sum, value) => sum + value, 0);
                document.getElementById('income-summary').textContent = total.toLocaleString() + ' บาท';
            }
            
            // อัพเดทสรุปค่าลดหย่อน
            function updateDeductionsSummary() {
                const total = Object.values(deductionData).reduce((sum, value) => sum + value, 0);
                document.getElementById('deductions-summary').textContent = total.toLocaleString() + ' บาท';
            }
            
            // แสดงผลการคำนวณ
            function displayResults() {
                const result = calculateTotalTax();
                
                document.getElementById('total-income').textContent = result.totalIncome.toLocaleString() + ' บาท';
                document.getElementById('total-expenses').textContent = result.totalExpenses.toLocaleString() + ' บาท';
                document.getElementById('net-income').textContent = result.netIncome.toLocaleString() + ' บาท';
                document.getElementById('total-deductions').textContent = result.totalDeductions.toLocaleString() + ' บาท';
                document.getElementById('taxable-income').textContent = result.taxableIncome.toLocaleString() + ' บาท';
                document.getElementById('tax-amount').textContent = result.tax.toLocaleString() + ' บาท';
                
                // แสดงรายละเอียดการคำนวณภาษี
                const taxBreakdownEl = document.getElementById('tax-breakdown');
                taxBreakdownEl.innerHTML = '';
                
                result.taxBreakdown.forEach(bracket => {
                    const bracketEl = document.createElement('div');
                    bracketEl.className = 'summary-row';
                    bracketEl.innerHTML = `<span>${bracket.range} บาท (${bracket.rate}):</span><span>${bracket.tax} บาท</span>`;
                    taxBreakdownEl.appendChild(bracketEl);
                });
                
                // แสดงโอกาสลดหย่อนเพิ่มเติม
                document.getElementById('max-life-health').textContent = result.availableLifeHealth.toLocaleString() + ' บาท';
                document.getElementById('max-pension').textContent = result.availablePension.toLocaleString() + ' บาท';
                document.getElementById('potential-savings').textContent = 
                    result.potentialSavings.toLocaleString() + ' บาท (' + result.savingsPercentage + '%)';
            }
            
            // Event Listeners
            document.getElementById('income-header').addEventListener('click', function() {
                const body = document.getElementById('income-body');
                body.classList.toggle('hidden');
            });
            
            document.getElementById('deductions-header').addEventListener('click', function() {
                const body = document.getElementById('deductions-body');
                body.classList.toggle('hidden');
            });
            
            document.getElementById('results-header').addEventListener('click', function() {
                const body = document.getElementById('results-body');
                body.classList.toggle('hidden');
            });
            
            document.getElementById('confirm-income').addEventListener('click', function() {
                document.getElementById('income-body').classList.add('hidden');
                updateIncomeSummary();
            });
            
            document.getElementById('confirm-deductions').addEventListener('click', function() {
                document.getElementById('deductions-body').classList.add('hidden');
                updateDeductionsSummary();
            });
            
            document.getElementById('calculate-tax').addEventListener('click', function() {
                document.getElementById('results-body').classList.remove('hidden');
                displayResults();
            });
            
            document.getElementById('reset-form').addEventListener('click', function() {
                // รีเซ็ตข้อมูล
                incomeData = {
                    type1: 0,
                    type1Other: 0,
                    type2: 0,
                    type3: 0,
                    type4_1: 0,
                    type4_2: 0,
                    type5: 0,
                    type6: 0,
                    type7: 0,
                    type8: 0
                };
                
                deductionData = {
                    life: 0,
                    health: 0,
                    illness: 0,
                    pension: 0,
                    pvf: 0,
                    donation: 0,
                    housingLoan: 0,
                    personal: 60000,
                    spouse: 0,
                    children: 0
                };
                
                // รีเซ็ตฟอร์ม
                document.querySelectorAll('.income-input').forEach(input => {
                    input.value = '';
                });
                
                document.querySelectorAll('.deduction-input').forEach(input => {
                    input.value = '';
                });
                
                document.getElementById('deduction-personal').value = '60000';
                
                // รีเซ็ตสรุป
                updateIncomeSummary();
                updateDeductionsSummary();
                
                // ซ่อนผลลัพธ์
                document.getElementById('results-body').classList.add('hidden');
            });
            
            // อัพเดทข้อมูลเมื่อผู้ใช้กรอกข้อมูล
            document.querySelectorAll('.income-input').forEach(input => {
                input.addEventListener('input', function() {
                    const type = this.getAttribute('data-type');
                    const value = parseFloat(this.value) || 0;
                    
                    switch(type) {
                        case '1':
                            if (this.id === 'income-type1') {
                                incomeData.type1 = value;
                            } else {
                                incomeData.type1Other = value;
                            }
                            break;
                        case '2':
                            incomeData.type2 = value;
                            break;
                        case '3':
                            incomeData.type3 = value;
                            break;
                        case '4':
                            if (this.id === 'income-type4-1') {
                                incomeData.type4_1 = value;
                            } else {
                                incomeData.type4_2 = value;
                            }
                            break;
                        case '5':
                            incomeData.type5 = value;
                            break;
                        case '6':
                            incomeData.type6 = value;
                            break;
                        case '7':
                            incomeData.type7 = value;
                            break;
                        case '8':
                            incomeData.type8 = value;
                            break;
                    }
                    
                    updateIncomeSummary();
                });
            });
            
            document.querySelectorAll('.deduction-input').forEach(input => {
                input.addEventListener('input', function() {
                    const id = this.id;
                    const value = parseFloat(this.value) || 0;
                    
                    switch(id) {
                        case 'deduction-life':
                            deductionData.life = value;
                            break;
                        case 'deduction-health':
                            deductionData.health = value;
                            break;
                        case 'deduction-illness':
                            deductionData.illness = value;
                            break;
                        case 'deduction-pension':
                            deductionData.pension = value;
                            break;
                        case 'deduction-pvf':
                            deductionData.pvf = value;
                            break;
                        case 'deduction-donation':
                            deductionData.donation = value;
                            break;
                        case 'deduction-housing-loan':
                            deductionData.housingLoan = value;
                            break;
                        case 'deduction-spouse':
                            deductionData.spouse = value;
                            break;
                        case 'deduction-children':
                            deductionData.children = value;
                            break;
                    }
                    
                    updateDeductionsSummary();
                });
            });
        });
    </script>
</body>
</html>
